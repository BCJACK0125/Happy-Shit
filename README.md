### **「屎地圖 Happy Shit」手機應用程式設計需求說明書**



**一、 專案目標**

將「拉屎／尿尿紀錄」這個日常、私密又有點惡趣味的行為，轉化為一個在手機上瀏覽體驗順暢、兼具娛樂與數據統計的「互動小工具」。  
此工具需具備 **響應式設計** 與流暢動畫，在手機上呈現如原生 App 般的體驗，並結合定位服務與統計資訊，讓使用者可以：

* 以角色身份記錄每一次上廁所（尿尿／大便）
* 在地圖上視覺化自己的「勢力範圍」
* 將拉屎時間轉換為金錢、重量與有趣排行，提升使用者黏著度與分享樂趣


**二、 視覺與設計風格**

*   **首選風格：療癒系惡趣味 × 現代極簡風**

	*   **色彩：**  
		* 主色調：`#6B4F3F`（溫暖咖啡棕，聯想到「大便」但仍保持溫和質感）  
		* 輔色一：`#FFF7E9`（奶油米白，作為背景主色，營造柔和感）  
		* 輔色二：`#FFD166`（亮黃橘，用於重要按鈕與強調文字，帶點「危險／急著上廁所」的趣味）  
		* 點綴色：`#4ECDC4`（蒂芬妮綠，用於地圖標記、角色區分或完成狀態）

	*   **字體：**  
		* 中文：`Noto Sans TC` 或同級無襯線字體  
		* 英文／數字：`Inter` 或 `SF Pro Text`  
		需確保在小螢幕上字級清晰、易讀，重要數字（時間、金額、重量）可略放大。

	*   **設計元素：**  
		* 大量留白，搭配圓角卡片與柔和陰影。  
		* 便便相關圖示採「Q 萌扁平風」，避免過度寫實或令人不適。  
		* 可在背景使用非常淡的排泄物圖示／水波紋作為紋理點綴，但不影響閱讀。

*   **設計原則：**

	1.  **手機優先：**  
		* 主要為單欄垂直捲動介面。  
		* 觸控按鈕與圖示點擊區不小於 44×44 px。  

	2.  **資訊層級分明：**  
		* 角色資訊、當前累積數據以較大字級與高對比色呈現。  
		* 次要說明與提示以較淡顏色（如 #8A8A8A）顯示。  

	3.  **直觀導航：**  
		* 使用底部固定導航欄（Tab Bar）切換主要功能：`地圖`、`紀錄`、`總覽`、`必拉榜`、`角色`。  
		* 導航圖示以簡單圖標（地圖標記、馬桶、統計圖、排行榜、人物頭像）搭配短文字標籤。

	4.  **趣味與尊重感並存：**  
		* 介面用詞可以輕鬆幽默，但需避免羞辱或冒犯使用者。  
		* 使用「你今天又征服了新的馬桶！」、「今天拉屎薪資已突破 100 元」等正向、有趣提示。



**三、 核心功能與頁面詳述**



**1. 登入與角色選擇頁（index.html）**

*   **初始動畫區：**

	* 螢幕中央播放一段簡短的 Q 萌大便動畫（例如：便便從天而降，落在馬桶上，冒出微笑表情）。  
	* 動畫結束後淡出，顯示角色選擇區。

*   **角色選擇區（角色輪播）：**

	* 以 **水平滑動卡片 Carousel** 呈現各角色。  
	* 每張角色卡片內容：
		* 角色頭像（預設角色圖案或使用者選擇的形象）  
		* 角色 ID（使用者自訂名稱，如「社畜小王」、「咖啡拉屎王」）  
		* 月薪（數字＋幣別，例如：`NT$ 45,000 / 月`）  
	* 使用者可左右滑動切換角色，**以畫面中央置中的卡片為目前選取角色**，卡片可放大或帶有陰影強調。

*   **主操作按鈕：**

	* `以此角色登入`（主 CTA 按鈕，使用亮色 `#FFD166`）  
		* 點擊後進入主頁 `HappyShit.html`，並將此角色設定為當前使用角色。  

	* `新增角色`（次要按鈕，線框樣式）  
		* 點擊後開啟角色建立流程（可使用全畫面或底部彈出表單）。

*   **新增角色流程：**

	* **步驟 1 – 選擇頭像：**  
		* 顯示多個預設人物／便便風格頭像供選擇（辦公族、學生、運動員等）。  

	* **步驟 2 – 輸入基本資料：**  
		* 角色 ID（必填，字數限制與重複檢查）  
		* 月薪（必填，數字輸入，可選幣別，預設 NT$）  
		* （選填）備註，如職業或公司名稱  

	* **步驟 3 – 確認與儲存：**  
		* 確認卡片預覽後按「完成建立」  
		* 儲存角色資料，並返回角色選擇頁，新增角色即出現在輪播列表中。  



**2. 主頁與底部導航（HappyShit.html）**

*   **頂部角色資訊列：**

	* 左側顯示當前角色頭像與 ID。  
	* 右側顯示：
		* 當月累積「拉屎薪資」金額（例：`本月拉屎薪資：NT$ 1,280`）  
		* 當月累積「屎量」或「尿量」摘要（可輪播顯示）。

*   **底部導航欄：**

	* `地圖` | `拉屎紀錄` | `總覽` | `必拉榜` | `角色`  
	* 點擊切換對應分頁（單頁應用程式內部切換，不重新載入）。  



**3. 地圖頁：「屎勢力地圖」**

*   **主要功能：** 在地圖上呈現各角色的上廁所地點，透過標記與凸包（勢力範圍）顯示分布。

*   **佈局：**

	* 上方為角色篩選區，下方為全螢幕地圖。  
	* 頂部可顯示當前角色名稱與本角色地點數量，例如：`小王的勢力範圍（共 18 個點）`。

*   **地圖顯示內容：**

	* 使用手機內建地圖 SDK 或 Web 地圖（如 Google Maps / Leaflet）。  
	* 將當前角色所有上過廁所的地點以標記（marker）呈現，標記圖示可以是小馬桶或便便 icon。  
	* 點擊標記時，彈出資訊視窗顯示：
		* 地點名稱（使用者命名）  
		* 最佳評分紀錄（最高分）  
		* 累積上廁所次數  
		* 最近一次上廁所時間  

*   **角色篩選與疊加顯示：**

	* 於地圖上方提供「查看其他角色」按鈕或篩選列：  
		* 點擊後展開角色列表（多選 Checkbox 形式）：  
			* `☑ 小王（咖啡社畜）`  
			* `☐ 小美（健身少女）`  
			* ...  
		* 使用者可勾選多個角色，一併顯示在地圖上。
	* 每一個角色使用不同顏色的標記與凸包邊線，以區分勢力範圍。

*   **勢力範圍（凸包顯示）：**

	* 若地圖上有多於一位角色的地標：
		* 對每個角色分別計算地點的凸包（Convex Hull）。  
		* 在地圖上用半透明色塊（如 `rgba(78, 205, 196, 0.15)`）填滿凸包區域，邊線略深。  
	* 視覺效果類似「勢力地圖」，讓使用者一目了然自己「征服過」哪些地區。  



**4. 拉屎紀錄頁：「立即紀錄」**

*   **主要流程：**  
	自動取得位置 → 選擇「尿尿／大便」 → 計時 → 計算尿量或拉屎金額／重量 → 命名與評分 → 儲存。

*   **版面結構：**

	* 上方顯示當前角色與目前定位狀態（如「定位中...」「已定位：台北市信義區」）。  
	* 中間為紀錄類型選擇與計時器區塊。  
	* 下方為命名、評分與儲存按鈕。

*   **步驟 1 – 位置自動記錄：**

	* 進入頁面即啟動 GPS 定位，取得經緯度。  
	* 若定位失敗，顯示錯誤提示並允許手動輸入地點名稱（例如：`公司 7 樓廁所`）。

*   **步驟 2 – 選擇類型：**

	* `尿尿` 與 `大便` 兩個大按鈕，預設未選取。  
	* 使用者點選其中一種後，才可啟動計時器。

*   **步驟 3 – 計時器：**

	* 顯示大字秒數計時（例如：`00:00` → `00:37`）。  
	* 提供 `開始`、`暫停`、`結束` 按鈕。  
	* 計時完成後自動帶入秒數至後續計算。

*   **步驟 4A – 尿尿紀錄計算：**

	* 公式：  
		* **尿量（cc） = 計時秒數 × 20 cc**  
	* 計時結束後自動顯示：  
		* `本次尿尿時間：37 秒`  
		* `估計尿量：約 740 cc`  
	* 提供可微調的輸入欄位（若使用者覺得估算值不準，可手動修改 cc）。

*   **步驟 4B – 大便紀錄計算：**

	* 金錢價值：  
		* 角色建立時已填寫「月薪」。  
		* 需在後端統一定義「每秒薪資」的換算方式（例如：  
		  `每秒薪資 = 月薪 / (30 天 × 24 小時 × 60 分鐘 × 60 秒)`）。  
		* **拉屎金額 = 計時秒數 × 每秒薪資**。  
	* 顯示範例：  
		* `本次拉屎時間：245 秒`  
		* `本次拉屎薪資：約 NT$ 31.50`  

	* 大便重量估算：  
		* 詢問使用者主觀評估：「你覺得這次的量？」  
		* 選項與對應重量：  
			* `偏少` → 150 g  
			* `正常` → 225 g  
			* `偏多` → 300 g  
			* `巨量` → 350 g  
		* 使用者點選其中一項後，系統記錄對應重量。

*   **步驟 5 – 地點命名與評分：**

	* 地點名稱（必填）：  
		* 例如：「公司 7F 靠窗那間」、「家裡主浴室」、「星巴克 A 店廁所」  
	* 評分：  
		* 1.0 ~ 10.0 分，允許到小數點後一位。  
		* 可用滑桿或星星評分搭配數字輸入框。  
	* （選填）備註文字欄位，供輸入如「廁紙很粗」、「有音樂遮掩聲音」、「異味很重」等。

*   **步驟 6 – 儲存紀錄：**

	* 按下「儲存紀錄」後：  
		* 將本次紀錄（角色、類型、時間、尿量／金額、重量、地點、評分、備註、經緯度、時間戳記）寫入資料庫或本機儲存。  
		* 提供簡短成功動畫（如便便露出笑臉、勾勾），並顯示累積更新結果。  



**5. 總覽頁：「屎生大數據」**

*   **主要目標：** 以視覺化圖表與統計數據呈現角色的長期「拉屎／尿尿表現」。

*   **版面結構：**

	* 以多個卡片區塊呈現不同指標，每個卡片簡潔明瞭，可左右滑動查看更多。

*   **指標範例：**

	1.  **勢力範圍擴張度：**  
		* 比較角色在不同時間區間的凸包面積變化，例如：  
			* `本月勢力範圍較上月 +35%`  
		* 可簡單以數字＋箭頭＋小型線圖或區域圖表示。

	2.  **累積尿量：**  
		* 顯示總尿量（例：`累積尿量：12,340 cc`），並換算為趣味單位（如「約 61 杯手搖飲」）。  
		* 可視情況加入日／週／月的折線圖。

	3.  **累積屎量：**  
		* 顯示總屎量（例：`累積屎量：7.2 kg`）。  
		* 可加上對比（如「約等於一隻貓的重量」）。

	4. **累積拉屎金額：**  
		* 顯示使用者已在馬桶上「領走」多少薪資（例：`累積拉屎薪資：NT$ 3,820`）。  
		* 可加入對比提示：`約等於一張 Switch 遊戲卡帶的價格` 等。

	5. **頻率與習慣分析（選配）：**  
		* 每日平均上廁所次數。  
		* 一週中哪一天最常拉屎。  
		* 一天中哪個時段最常拉屎（早上、中午、晚上）。  

*   **互動設計：**

	* 可切換統計期間（`本週` / `本月` / `全部`）。  
	* 若資料不足，顯示引導提示，鼓勵使用者多紀錄。  



**6. 必拉榜頁：「傳說中的廁所」**

*   **主要功能：** 根據使用者對各地點的評分，生成排行榜，鼓勵探索與分享。

*   **佈局：**

	* 以列表呈現，排序方式預設為「評分由高到低」。  
	* 每個地點卡片顯示：  
		* 名稱（地點命名）  
		* 平均評分（1.0 - 10.0）  
		* 累積上廁所次數  
		* 最近一次造訪時間  
		* 地點類型或標籤（可由使用者自訂，如「公司」、「家」、「咖啡廳」）。

*   **排序與篩選：**

	* 排序選項：  
		* `評分最高`  
		* `造訪次數最多`  
		* `最近造訪`  
	* 篩選條件（選配）：  
		* 類型（公司／住家／公共場所）  
		* 僅顯示「大便紀錄」或「尿尿紀錄」。  

*   **額外互動（未來擴充）：**

	* 可加入「標記為最愛」、「分享截圖」等功能，供使用者在社群媒體上分享自己的「必拉榜」。  



**四、 技術與互動需求**

1.  **響應式設計：**

    * 介面需針對手機螢幕優化，特別是 375px（iPhone SE）至 414px（iPhone Pro）寬度範圍。  
    * 採用單頁式（SPA）設計，透過前端路由或條件渲染切換各分頁內容。  

2.  **定位與地圖整合：**

    * 使用 HTML5 Geolocation API 或原生 App API 取得經緯度。  
    * 地圖可優先使用 Web 版地圖 SDK（如 Google Maps JS / Leaflet）：  
        * 支援標記（Marker）、資訊視窗（InfoWindow）、多邊形（Polygon，凸包）。  
    * 凸包計算可於前端使用演算法（如 Graham Scan 或現成套件）完成。

3.  **資料結構與儲存：**

    * 角色資料：ID、頭像、月薪、幣別、建立時間等。  
    * 紀錄資料：角色 ID、類型（尿／屎）、開始時間、時長、尿量／屎量、拉屎金額、評分、備註、地點名稱、經緯度。  
    * 初版可使用瀏覽器 LocalStorage / IndexedDB 儲存，未來可切換至後端 API（如 REST / GraphQL）。

4.  **計時與計算模組：**

    * 前端以 JavaScript 實作穩定計時功能，需處理切到背景時的誤差（可記錄開始／結束時間戳）。  
    * 將「尿量」「每秒薪資」「屎量」等計算抽成獨立模組，方便日後調整公式。  

5.  **動畫與效能：**

    * 初始便便動畫可使用 CSS 動畫 或 輕量 SVG 動畫，避免影響載入速度。  
    * 地圖與統計圖表應做好 lazy loading，避免一次載入過多資料。

6.  **輸出形式與整合：**

    * 以 **單一 HTML 檔案** 為主（例如 `index.html`），內嵌或引用必要的 CSS、JavaScript 檔案，以確保容易部署與測試。  
    * `index.html` 中可包含角色選擇與所有分頁的結構，透過 JavaScript 控制顯示／隱藏。  
    * 若日後包成 WebView 或 PWA，現有結構應能直接沿用。


---

## 版本更新紀錄（Changelog）

> 註：以下為原型/需求文件的迭代紀錄（同日多次更新以功能點區分）。

### v0.0.0（需求文件初版）
- 建立 `HappyShit/ReadMe.md` 需求說明書骨架與初版內容。

### v0.0.1（需求文件改版）
- 依新版需求補齊/覆寫：視覺風格、5 分頁架構（含「角色」）、互動與技術需求細節。

### v0.0.2（前端原型：登入/角色）
- 新增 `HappyShit/index.html`：角色輪播、建立角色、LocalStorage seed、登入跳轉 `HappyShit.html?role=...`。

### v0.0.3（前端原型：主頁 SPA）
- 新增 `HappyShit/HappyShit.html`：5 tabs（地圖/紀錄/總覽/必拉榜/角色）、LocalStorage 讀寫、匯出 JSON。
- 地圖：Leaflet + OSM markers、角色多選疊加、每角色凸包（convex hull）半透明勢力範圍。
- 紀錄：定位 + 計時 + 尿量/拉屎薪資/屎量 + 命名評分 + 儲存。

### v0.0.4（地圖/分頁可靠性）
- 地圖預設視角固定台北市（無資料時）。
- Leaflet/圖磚載入失敗時顯示提示，避免 JS 中斷導致分頁無法切換。

### v0.0.5（定位體驗）
- 地圖頁新增「回到目前位置」按鈕，並在地圖上顯示使用者位置點。
- 定位改為兩段式（快取定位 → 高精度定位），並加入 last known fallback 與更清楚錯誤訊息。
- 進入地圖分頁自動定位一次（含 cooldown，避免頻繁觸發）。

### v0.0.6（紀錄頁互動優化）
- 計時器開始/暫停按鈕加入狀態回饋（文字/高亮/disabled）。
- 儲存成功後重置輸入欄位（地點、評分、備註、標籤、尿量/屎量）與計時/類型。
- 「開始新紀錄」定位若接近已儲存地點（約 60m 內），跳出確認並可一鍵填入地點名稱。

### v0.0.7（地圖/角色/總覽互動）
- 地圖地點標記改為 💩 便便圖案（依角色顏色顯示外框），提升趣味性與辨識度。
- 角色頁新增「刪除角色」：確認提示、刪除同時移除該角色所有紀錄，且至少保留 1 個角色；若刪除的是當前角色會自動切換。
- 總覽頁 KPI 卡片可點擊：彈窗顯示跨角色排名、與上一名差距，並對前三名顯示激勵文案。

### v0.0.8（互動/碼表/排版修正）
- 登入頁動畫新增互動：點馬桶會讓便便「往上跳一下」（進場掉落與點擊跳躍分離，避免重複掉落）。
- 紀錄頁碼表按鈕修復：選擇類型後「開始」立即可用；開始後可立刻「暫停/結束」；暫停後可「繼續」。
- 角色頁排版修復：加入按鈕區自動換行與小螢幕適配，避免「切換/刪除」擠爆版面。

### v0.0.9（儲存回饋/幹話客製/刪除單筆紀錄）
- 儲存成功強回饋：新增成功 toast（並在成功後清空欄位，讓使用者更有「已存檔」的感覺）。
- 總覽 KPI 幹話客製：四個指標（勢力/薪資/屎量/尿量）各自有不同的「第一名」與「前三名精神喊話」文案。
- 必拉榜新增「最近紀錄（可刪除）」：最多顯示 20 筆、支援單筆刪除（含確認視窗），刪除後同步刷新地圖/總覽/榜單。
- 最近紀錄清單改為「按下展開/收起」才渲染，避免頁面太長。
- 相容性修正：自動補齊舊資料缺漏的 `recordId`；Leaflet 失敗時地圖渲染會安全跳過，避免影響儲存/刪除流程。
